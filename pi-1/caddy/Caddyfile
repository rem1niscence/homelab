(network_paths) {
  redir /pihole /pihole/admin/
  redir /pihole/ /pihole/admin/
  redir /portainer /portainer/
  redir /grafana /grafana/
  redir /jellyfin /jellyfin/
  redir /torrent /torrent/

  handle_path /pihole/* {
    reverse_proxy /* pihole:80
  }
  handle_path /portainer/* {
    reverse_proxy /* portainer:9000
  }
  
  handle_path /grafana/* {
    reverse_proxy grafana:3000  
  }
  
   handle_path /jellyfin/* {
            rewrite * /jellyfin{uri}
            reverse_proxy jellyfin:8096
   }

  handle_path /torrent/* {
    reverse_proxy /* qbittorrent:8100  
  }

  # Not working
  # handle_path /umami/* {
  #   reverse_proxy /* umami:3000  
  # }
  # @umami {
	#   header Referer *umami*
  # }
  # reverse_proxy @umami /* umami:3000

  respond 404
}

{$SERVER_URL} {
  import network_paths
}
